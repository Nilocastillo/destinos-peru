---
import Icon from "./Icon.astro";
import { getCollection } from "astro:content";
import { Image } from "astro:assets";

const tours = await getCollection("tours");
const packages = tours
  .filter((tour) => tour.data.category.includes("Paquetes"))
  .sort((a, b) => b.data.order - a.data.order);
---

<section id="paquetes" class="py-24 bg-white">
  <div class="max-w-7xl mx-auto px-6 lg:px-8">
    <div class="text-center mb-16">
      <span
        class="text-brand-green font-bold tracking-widest text-xs uppercase mb-2 block"
        >Experiencias Completas</span
      >
      <h2 class="text-3xl md:text-4xl font-bold text-slate-900">
        Paquetes Turísticos
      </h2>
      <p class="text-gray-500 mt-4">
        Itinerarios diseñados para disfrutar lo mejor del Perú.
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {
        packages.map((tour) => (
          <a
            href={`/tours/${tour.slug}`}
            class="group bg-white rounded-2xl overflow-hidden shadow-soft hover:shadow-2xl transition duration-300 cursor-pointer border border-gray-100 block"
          >
            <div class="h-64 overflow-hidden relative">
              <Image
                src={tour.data.image}
                alt={tour.data.alt}
                width={800}
                height={600}
                class="w-full h-full object-cover transition duration-700 group-hover:scale-110"
                widths={[320, 640, 800]}
                sizes="(min-width: 1024px) 33vw, (min-width: 768px) 50vw, 100vw"
                decoding="async"
                loading="lazy"
                fetchpriority="low"
              />
              <div class="absolute top-4 left-4 bg-brand-red/90 backdrop-blur px-3 py-1 rounded text-xs font-bold text-white uppercase">
                {tour.data.duration}
              </div>
            </div>
            <div class="p-6">
              <div class="flex text-yellow-400 mb-2">
                {[...Array(5)].map(() => (
                  <Icon
                    name="star"
                    class="w-4 h-4 text-yellow-400 filled-star"
                  />
                ))}
              </div>
              <h3 class="text-xl font-bold text-slate-900 mb-2">
                {tour.data.title}
              </h3>
              <p class="text-sm text-gray-500 mb-4 line-clamp-2">
                {tour.data.description}
              </p>
              <div class="text-brand-green font-bold text-sm flex items-center translate-y-4 opacity-0 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-300">
                Ver Itinerario <Icon name="arrow-right" class="w-4 h-4 ml-2" />
              </div>
            </div>
          </a>
        ))
      }
    </div>
  </div>
</section>
